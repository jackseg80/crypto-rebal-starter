<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analytics Unifi√©s - Crypto Rebalancer</title>
  <link rel="stylesheet" href="shared-theme.css">
  <link rel="stylesheet" href="theme-compat.css">
  <link rel="stylesheet" href="analytics-unified-theme.css?v=20251015fixed">
  <link rel="stylesheet" href="components/governance-panel.css">
  <link rel="stylesheet" href="components/decision-index-panel.css?v=20251015fixed">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <script>
    // ‚úÖ Enregistrement datalabels (idempotent)
    if (window.Chart && window.ChartDataLabels && !window.__di_dl_registered__) {
      window.Chart.register(window.ChartDataLabels);
      // ‚úÖ D√©sactiver globalement, puis r√©activer seulement sur barre empil√©e
      window.Chart.defaults.set('plugins.datalabels', { display: false });
      window.__di_dl_registered__ = true;
      console.debug('‚úÖ chartjs-plugin-datalabels registered (global display: false)');
    }

    // ‚úÖ Enregistrement annotation plugin pour Bitcoin regime events
    if (window.Chart && window.ChartAnnotation && !window.__di_annotation_registered__) {
      window.Chart.register(window.ChartAnnotation);
      window.__di_annotation_registered__ = true;
      console.debug('‚úÖ chartjs-plugin-annotation registered');
    }
  </script>
  <script src="debug-logger.js"></script>
  <script src="global-config.js"></script>
  <script src="appearance.js"></script>
  <script type="module" src="components/nav.js"></script>
  <script type="module" src="analytics-unified.js"></script>
  <script type="module">
    import { initDeepLinks } from './components/deep-links.js';
    import {
      selectContradiction01,
      selectEffectiveCap,
      selectGovernanceTimestamp
    } from './selectors/governance.js';

    // Rendre les s√©lecteurs accessibles globalement
    window.selectContradiction01 = selectContradiction01;
    window.selectEffectiveCap = selectEffectiveCap;
    window.selectGovernanceTimestamp = selectGovernanceTimestamp;

    // Ancres pour analytics-unified.html - pointent vers le contenu r√©el
    initDeepLinks({
      'unified-root': 'Analytics Unifi√©s',
      'tab-intelligence-ml': 'Intelligence ML',
      'tab-risk': 'Risk Dashboard',
      'tab-performance': 'Performance Monitor',
      'tab-cycles': 'Cycle Analysis',
      'tab-monitoring': 'Advanced Analytics'
    });
  </script>
  <script type="module" src="modules/analytics-unified-main-controller.js"></script>
  <style>
    .wrap {
      max-width: 95vw;
      margin: 0 auto;
      padding: var(--space-lg);
    }

    .tabs {
      display: flex;
      gap: .5rem;
      border-bottom: 1px solid var(--theme-border);
    }

    .tab-btn {
      padding: .6rem .9rem;
      border: 1px solid var(--theme-border);
      background: var(--theme-surface);
      color: var(--theme-text);
      border-radius: var(--radius-sm) var(--radius-sm) 0 0;
      cursor: pointer;
    }

    .tab-btn.active {
      border-color: var(--brand-primary);
      color: var(--brand-primary);
      background: color-mix(in oklab, var(--brand-primary) 10%, transparent);
    }

    .btn-refresh {
      padding: .6rem .9rem;
      border: 1px solid var(--theme-border);
      background: var(--theme-surface);
      color: var(--theme-text);
      border-radius: var(--radius-sm);
      cursor: pointer;
      margin-left: auto;
      transition: all 0.2s;
    }

    .btn-refresh:hover {
      background: var(--brand-primary);
      color: white;
      border-color: var(--brand-primary);
    }

    .tab-panel {
      display: none;
    }

    .tab-panel.active {
      display: block;
    }

    .panel-card {
      background: var(--theme-surface);
      border: 1px solid var(--theme-border);
      border-radius: var(--radius-lg);
      padding: var(--space-md);
    }

    .metric-card {
      background: var(--theme-bg);
      border: 1px solid var(--theme-border);
      border-radius: var(--radius-md);
      padding: 1rem;
      text-align: center;
    }

    .metric-card h4 {
      margin: 0 0 0.5rem 0;
      font-size: 0.9rem;
      color: var(--theme-text-muted);
      font-weight: 500;
    }

    .metric-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--theme-text);
      margin: 0.5rem 0;
    }

    .metric-card small {
      color: var(--theme-text-muted);
      font-size: 0.8rem;
    }
  </style>
  <script type="module" src="components/tooltips.js"></script>

  <!-- Risk Dashboard Store + Calculation Modules (for flyout panel parity) -->
  <!-- global-config.js already loaded in head, don't reload -->
  <script type="module" src="core/risk-dashboard-store.js"></script>
  <script type="module" src="core/fetcher.js"></script>
  <script type="module" src="modules/signals-engine.js"></script>
  <script type="module" src="modules/cycle-navigator.js"></script>
  <script type="module" src="modules/onchain-indicators.js"></script>
  <script type="module" src="modules/market-regimes.js"></script>
  <script type="module" src="modules/targets-coordinator.js"></script>
  <script type="module" src="core/risk-data-orchestrator.js"></script>
</head>

<body>
  <div id="backend-fallback-banner"
    style="display:none; background: color-mix(in oklab, var(--warning) 20%, transparent); border: 1px solid var(--warning); color: var(--theme-text); padding: .6rem; margin: .5rem auto; max-width: 95vw; border-radius: 6px;">
    ‚ö† Backend indisponible ‚Äî mode prudent (cap r√©duit).
  </div>
  <div class="wrap">
    <!-- Governance Panel -->
    <div id="governance-container"></div>


    <div id="unified-root"></div>
    <div style="height: 1rem;"></div>
    <div class="tabs" id="analytics-tabs">
      <button class="tab-btn active" data-target="#tab-risk">Risk</button>
      <button class="tab-btn" data-target="#tab-performance">Performance</button>
      <button class="tab-btn" data-target="#tab-cycles">Cycles</button>
      <button class="tab-btn" data-target="#tab-monitoring">Monitoring</button>
      <button class="tab-btn" data-target="#tab-intelligence-ml">ü§ñ Intelligence ML</button>
      <button class="btn-refresh" id="manual-refresh-onchain" title="Forcer le rafra√Æchissement des indicateurs on-chain">üîÑ Actualiser</button>
    </div>
  </div>

  <section class="wrap tab-panel active" id="tab-risk">
    <div class="panel-card">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h3>üõ°Ô∏è Risk Dashboard</h3>
        <div id="risk-badge-container"></div>
      </div>
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <div class="metric-card" data-metric="risk-var">
          <h4>Portfolio VaR</h4>
          <div class="metric-value" id="risk-var-value">--</div>
          <small>95% confidence level</small>
        </div>
        <div class="metric-card" data-metric="risk-drawdown">
          <h4>Max Drawdown</h4>
          <div class="metric-value" id="risk-drawdown-value">--</div>
          <small>Current cycle</small>
        </div>
        <div class="metric-card" data-metric="risk-volatility">
          <h4>Volatility</h4>
          <div class="metric-value" id="risk-volatility-value">--</div>
          <small>30-day annualized</small>
        </div>
        <div class="metric-card" data-metric="risk-score">
          <h4>Risk Score</h4>
          <div class="metric-value" id="risk-score-value">--/100</div>
          <small>Unknown</small>
        </div>
      </div>
      <!-- Scores cl√©s du Risk Dashboard (version compl√®te) -->
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <div class="metric-card" data-metric="risk-kpi-diversification">
          <h4>Diversification Ratio</h4>
          <div class="metric-value">--</div>
          <small>Corr√©lation de portefeuille</small>
        </div>
        <div class="metric-card" data-metric="risk-kpi-effective-assets">
          <h4>Effective Assets</h4>
          <div class="metric-value">--</div>
          <small>Actifs non-redondants</small>
        </div>
        <div class="metric-card" data-metric="risk-kpi-blended">
          <h4>Score D√©cisionnel</h4>
          <div class="metric-value">--</div>
          <small>CCS √ó Cycle (synth√®se)</small>
        </div>
        <div class="metric-card" data-metric="risk-kpi-onchain">
          <h4>On-Chain Composite</h4>
          <div class="metric-value" id="risk-kpi-onchain-value">--</div>
          <small>Fondamentaux on-chain</small>
        </div>
      </div>
      <div style="margin-top: 2rem; padding: 1rem; background: var(--theme-bg); border-radius: var(--radius-md);">
        <h4>Risk Alerts</h4>
        <div style="color: var(--theme-text-muted);">‚Ä¢ Portfolio concentration within acceptable limits</div>
        <div style="color: var(--theme-text-muted);">‚Ä¢ Correlation risk moderate for current market conditions</div>
        <div style="color: var(--theme-text-muted);">‚Ä¢ No significant exposure warnings</div>
      </div>
      <div style="text-align: center; margin-top: 1.5rem; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
        <a href="risk-dashboard.html?nav=off" target="_blank"
          style="display: inline-block; background: var(--brand-primary); color: white; padding: 0.75rem 1.5rem; border-radius: var(--radius-md); text-decoration: none; font-weight: 600;">
          üìä Version compl√®te du Risk Dashboard
        </a>
        <a href="simulations.html?nav=off" target="_blank"
          style="display: inline-block; background: var(--success); color: white; padding: 0.75rem 1.5rem; border-radius: var(--radius-md); text-decoration: none; font-weight: 600;">
          üß™ Simulateur Pipeline Complet
        </a>
      </div>
    </div>
  </section>
  <section class="wrap tab-panel" id="tab-performance">
    <div class="panel-card">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h3>üìä Performance Monitor</h3>
        <div id="performance-badge-container"></div>
      </div>
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <div class="metric-card" data-metric="perf-cache-size">
          <h4>Memory Cache Size</h4>
          <div class="metric-value">--</div>
          <small>Memory cache entries</small>
        </div>
        <div class="metric-card" data-metric="perf-disk-cache">
          <h4>Disk Cache Usage</h4>
          <div class="metric-value">-- MB</div>
          <small>Disk cache usage</small>
        </div>
        <div class="metric-card" data-metric="perf-memory">
          <h4>Process Memory</h4>
          <div class="metric-value">-- MB</div>
          <small>Process memory</small>
        </div>
        <div class="metric-card" data-metric="perf-system-memory">
          <h4>System Memory Usage</h4>
          <div class="metric-value">--%</div>
          <small>System memory usage</small>
        </div>
      </div>
      <div style="margin-top: 2rem; padding: 1rem; background: var(--theme-bg); border-radius: var(--radius-md);">
        <h4>System Performance</h4>
        <div style="display: grid; gap: 0.5rem;">
          <div style="display: flex; justify-content: space-between;"><span>Memory Cache Hit Rate:</span><span
              style="color: var(--success);">--%</span></div>
          <div style="display: flex; justify-content: space-between;"><span>Available Memory:</span><span>-- GB</span>
          </div>
          <div style="display: flex; justify-content: space-between;"><span>Process Efficiency:</span><span>--</span>
          </div>
        </div>
      </div>
      <div style="text-align: center; margin-top: 1.5rem;">
        <a href="performance-monitor-unified.html" target="_blank"
          style="display: inline-block; background: var(--brand-primary); color: white; padding: 0.75rem 1.5rem; border-radius: var(--radius-md); text-decoration: none; font-weight: 600;">
          üìà Performance Monitor Unifi√© (Nouveau)
        </a>
      </div>
    </div>
  </section>
  <section class="wrap tab-panel" id="tab-cycles">
    <div class="panel-card">
      <h3>üîÑ Cycle Analysis</h3>
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <div class="metric-card" data-metric="cycle-phase">
          <h4>Current Phase</h4>
          <div class="metric-value">--</div>
          <small>Current phase</small>
        </div>
        <div class="metric-card" data-metric="cycle-progress">
          <h4>Post-Halving Progress</h4>
          <div class="metric-value">-- months</div>
          <small>Post-halving progress</small>
        </div>
        <div class="metric-card" data-metric="cycle-score">
          <h4>Cycle Score</h4>
          <div class="metric-value">--</div>
          <small>Cycle position score</small>
        </div>
        <div class="metric-card" data-metric="cycle-confidence">
          <h4>Confidence</h4>
          <div class="metric-value">--%</div>
          <small>Model certainty</small>
        </div>
      </div>
      <div style="margin-top: 2rem; padding: 1rem; background: var(--theme-bg); border-radius: var(--radius-md);">
        <h4>Market Cycle Indicators</h4>
        <div style="display: grid; gap: 0.5rem;">
          <div style="display: flex; justify-content: space-between;"><span>Fear & Greed Index:</span><span>45
              (Neutral)</span></div>
          <div style="display: flex; justify-content: space-between;"><span>RSI (Weekly):</span><span>58
              (Neutral)</span></div>
          <div style="display: flex; justify-content: space-between;"><span>MVRV Ratio:</span><span>2.1
              (Accumulation)</span></div>
        </div>
      </div>
      <div style="text-align: center; margin-top: 1.5rem;">
        <a href="cycle-analysis.html?nav=off" target="_blank"
          style="display: inline-block; background: var(--brand-primary); color: white; padding: 0.75rem 1.5rem; border-radius: var(--radius-md); text-decoration: none; font-weight: 600;">
          üîÑ Version compl√®te du Cycle Analysis
        </a>
      </div>
    </div>
  </section>
  <section class="wrap tab-panel" id="tab-monitoring">
    <div class="panel-card">
      <h3>üìà Advanced Analytics</h3>
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <div class="metric-card" data-metric="monitor-total-return">
          <h4>Total Return</h4>
          <div class="metric-value">--%</div>
          <small>Sur la p√©riode</small>
        </div>
        <div class="metric-card" data-metric="monitor-sharpe">
          <h4>Sharpe Ratio</h4>
          <div class="metric-value">--</div>
          <small>Risque ajust√©</small>
        </div>
        <div class="metric-card" data-metric="monitor-volatility">
          <h4>Volatility</h4>
          <div class="metric-value">--%</div>
          <small>Risque de march√©</small>
        </div>
        <div class="metric-card" data-metric="monitor-drawdown">
          <h4>Max Drawdown</h4>
          <div class="metric-value">--%</div>
          <small>Pire baisse</small>
        </div>
      </div>
      <div style="margin-top: 2rem; padding: 1rem; background: var(--theme-bg); border-radius: var(--radius-md);">
        <h4>Advanced Metrics</h4>
        <div id="advanced-metrics-breakdown" style="display: grid; gap: 0.5rem;"></div>
      </div>
      <div style="text-align: center; margin-top: 1.5rem;">
        <a href="performance-monitor-unified.html" target="_blank"
          style="display: inline-block; background: var(--brand-primary); color: white; padding: 0.75rem 1.5rem; border-radius: var(--radius-md); text-decoration: none; font-weight: 600;">
          üìä Performance Monitor Unifi√©
        </a>
      </div>
    </div>
  </section>

  <!-- Intelligence ML Tab Panel -->
  <section class="wrap tab-panel" id="tab-intelligence-ml">
    <div class="panel-card">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h3>ü§ñ Intelligence ML - Vue Analyse Compl√®te</h3>
        <div id="intelligence-badge-container"></div>
      </div>
      <p style="color: var(--theme-text-muted); margin-bottom: 2rem;">
        Analyse d√©taill√©e des mod√®les ML, pr√©dictions temps r√©el et administration avanc√©e
      </p>

      <!-- Stats ML Globales -->
      <div class="ml-stats-section" style="margin-bottom: 2rem;">
        <h4 style="margin-bottom: 1rem;">üìä Statistiques ML Globales</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
          <div class="metric-card">
            <h5>Mod√®les Actifs</h5>
            <div class="metric-value" id="ml-active-models">--/4</div>
            <small>Mod√®les charg√©s</small>
          </div>
          <div class="metric-card">
            <h5>Confiance Moyenne</h5>
            <div class="metric-value" id="ml-avg-confidence">--%</div>
            <small>Niveau de confiance</small>
          </div>
          <div class="metric-card">
            <h5>Derni√®re Mise √† Jour</h5>
            <div class="metric-value" id="ml-last-update">--</div>
            <small>Status ML</small>
          </div>
        </div>
      </div>

      <!-- Vue Mod√®les D√©taill√©e -->
      <div class="ml-models-section" style="margin-bottom: 2rem;">
        <h4 style="margin-bottom: 1rem;">üß† Sant√© des Mod√®les</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
          <div class="metric-card">
            <h5>üåä Volatility LSTM</h5>
            <div class="metric-value" id="ml-vol-model-status">‚ö™ Unknown</div>
            <small id="ml-vol-model-details">Statut du mod√®le</small>
          </div>
          <div class="metric-card">
            <h5>üîÑ Regime HMM</h5>
            <div class="metric-value" id="ml-regime-model-status">‚ö™ Unknown</div>
            <small id="ml-regime-model-details">Statut du mod√®le</small>
          </div>
          <div class="metric-card">
            <h5>üîó Correlation Transformer</h5>
            <div class="metric-value" id="ml-corr-model-status">‚ö™ Unknown</div>
            <small id="ml-corr-model-details">Statut du mod√®le</small>
          </div>
          <div class="metric-card">
            <h5>üí≠ Sentiment Composite</h5>
            <div class="metric-value" id="ml-sent-model-status">‚ö™ Unknown</div>
            <small id="ml-sent-model-details">Statut du mod√®le</small>
          </div>
        </div>
      </div>

      <!-- Pr√©dictions Temps R√©el -->
      <div class="ml-predictions-section" style="margin-bottom: 2rem;">
        <h4 style="margin-bottom: 1rem;">üîÆ Pr√©dictions Temps R√©el</h4>
        <div id="ml-predictions-container" style="display: grid; gap: 1rem;">
          <div class="prediction-grid"
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <!-- Volatilit√© -->
            <div class="metric-card" data-metric="ml-volatility-btc">
              <h5>BTC Volatilit√© 24h</h5>
              <div class="metric-value" id="ml-vol-btc">--</div>
              <small>Pr√©diction LSTM</small>
            </div>
            <div class="metric-card" data-metric="ml-volatility-eth">
              <h5>ETH Volatilit√© 24h</h5>
              <div class="metric-value" id="ml-vol-eth">--</div>
              <small>Pr√©diction LSTM</small>
            </div>
            <!-- R√©gimes -->
            <div class="metric-card" data-metric="ml-regime">
              <h5>R√©gime March√©</h5>
              <div class="metric-value" id="ml-regime">--</div>
              <small>Classification HMM</small>
            </div>
            <!-- Sentiment -->
            <div class="metric-card" data-metric="ml-sentiment">
              <h5>Fear & Greed</h5>
              <div class="metric-value" id="ml-sentiment">--</div>
              <small>Composite Score</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Administration ML (repliable, RBAC protected) -->
      <details class="ml-admin-section" style="margin-bottom: 2rem;">
        <summary
          style="cursor: pointer; padding: 0.75rem; background: var(--theme-surface-elevated); border-radius: var(--radius-sm); font-weight: 600;">
          üîß Administration ML (Admin Only)
        </summary>
        <div
          style="padding: 1rem; border: 1px solid var(--theme-border); border-top: none; border-radius: 0 0 var(--radius-sm) var(--radius-sm);">
          <div id="ml-admin-ops-container"></div>

          <!-- Actions Admin -->
          <div class="admin-actions" style="display: flex; gap: 1rem; margin-top: 1rem; flex-wrap: wrap;">
            <button class="btn secondary" onclick="triggerMLRetraining()" id="btn-retrain">
              üîÑ Retrain Models
            </button>
            <button class="btn secondary" onclick="clearMLCache()" id="btn-clear-cache">
              üóëÔ∏è Clear Cache
            </button>
            <button class="btn secondary" onclick="downloadMLLogs()" id="btn-logs">
              üì• Download Logs
            </button>
            <button class="btn secondary" onclick="showMLDebug()" id="btn-debug">
              üîç Debug Info
            </button>
          </div>

          <!-- ML Pipeline Status -->
          <div class="ml-pipeline-status" style="margin-top: 1.5rem;">
            <h5 style="margin-bottom: 0.75rem;">Pipeline Status</h5>
            <div id="ml-pipeline-container"
              style="font-family: monospace; background: var(--theme-bg); padding: 1rem; border-radius: var(--radius-sm); font-size: 0.85rem;">
              Loading pipeline status...
            </div>
          </div>
        </div>
      </details>

      <!-- Lien vers Command Center -->
      <div style="text-align: center; margin-top: 2rem;">
        <a href="ai-dashboard.html" target="_blank"
          style="display: inline-block; background: var(--brand-primary); color: white; padding: 0.75rem 1.5rem; border-radius: var(--radius-md); text-decoration: none; font-weight: 600;">
          ü§ñ Ouvrir ML Command Center (Vue Ops)
        </a>
      </div>

      <!-- Bitcoin Regime Detection - Moved to AI Dashboard -->
      <div style="margin-top: 3rem; padding: 2rem; background: var(--theme-surface); border-radius: var(--radius-md); border: 2px solid var(--brand-primary); text-align: center;">
        <h3 style="margin-bottom: 1rem;">
          ‚Çø Bitcoin Regime Detection
        </h3>
        <p style="color: var(--theme-text-muted); margin-bottom: 1.5rem;">
          Cette fonctionnalit√© a √©t√© d√©plac√©e vers le <strong>Dashboard IA Unifi√©</strong> pour une meilleure centralisation de toute la d√©tection de r√©gimes (Stock Market + Bitcoin).
        </p>
        <a href="ai-dashboard.html" class="btn primary" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--brand-primary); color: white; text-decoration: none; border-radius: var(--radius-md); font-weight: 600;">
          üìà Ouvrir Dashboard IA ‚Üí R√©gimes de March√©
        </a>
        <div style="margin-top: 1rem; padding: 1rem; background: var(--theme-bg); border-radius: var(--radius-sm); text-align: left;">
          <strong>üìå Nouveau dans le Dashboard IA:</strong>
          <ul style="margin: 0.5rem 0 0 1.5rem; color: var(--theme-text-muted); font-size: 0.9rem;">
            <li><strong>Onglet "R√©gimes de March√©"</strong> - Centralise Stock Market + Bitcoin regime detection</li>
            <li><strong>Tableau Comparatif</strong> - Compare directement les r√©gimes Bourse vs Crypto</li>
            <li><strong>Graphiques Complets</strong> - Timeframe selector (1Y/2Y/5Y/10Y) + √©v√©nements annot√©s</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <script type="module" src="modules/analytics-unified-tabs-controller.js"></script>

  <style>
    /* Styles sp√©cifiques pour l'onglet Intelligence ML */
    .ml-stats-section,
    .ml-models-section,
    .ml-predictions-section,
    .ml-admin-section {
      background: var(--theme-surface);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      border: 1px solid var(--theme-border);
    }

    .prediction-grid .metric-card {
      transition: all 0.3s ease;
    }

    .prediction-grid .metric-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    /* Couleurs pour les r√©gimes */
    .metric-value.regime-bull {
      color: var(--success);
    }

    .metric-value.regime-bear {
      color: var(--danger);
    }

    .metric-value.regime-neutral {
      color: var(--warning);
    }

    /* Couleurs pour le sentiment */
    .metric-value.sentiment-fear {
      color: var(--danger);
    }

    .metric-value.sentiment-greed {
      color: var(--success);
    }

    .metric-value.sentiment-neutral {
      color: var(--theme-text);
    }

    .admin-actions .btn {
      font-size: 0.85rem;
      padding: 0.5rem 1rem;
    }

    .ml-pipeline-status {
      background: var(--theme-bg);
      border-radius: var(--radius-sm);
      padding: 1rem;
    }

    /* Responsive pour onglet ML */
    @media (max-width: 768px) {
      .prediction-grid {
        grid-template-columns: 1fr 1fr !important;
      }

      .admin-actions {
        flex-direction: column;
      }

      .admin-actions .btn {
        width: 100%;
      }
    }
  </style>

  <!-- Unified Risk Flyout Panel (Full Sidebar) -->
  <script type="module" src="components/flyout-panel.js"></script>
  <script type="module" src="components/risk-sidebar-full.js"></script>
  <script type="module">
    // Adapter le layout quand la sidebar est √©pingl√©e
    import { enableFlyoutLayoutAdapter } from './components/flyout-layout-adapter.js';
    enableFlyoutLayoutAdapter('.wrap'); // D√©caler uniquement le contenu, pas le menu
  </script>

  <flyout-panel position="left" width="340" persist-key="analytics_flyout">
    <span slot="title">üéØ Risk Dashboard</span>
    <risk-sidebar-full slot="content" poll-ms="0"></risk-sidebar-full>
  </flyout-panel>

</body>

</html>