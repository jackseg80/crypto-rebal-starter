<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Debug Badges</title>
    <link rel="stylesheet" href="shared-theme.css">
    <style>
        body { font-family: system-ui; padding: 2rem; background: var(--theme-background); color: var(--theme-text); }
        .container { max-width: 800px; margin: 0 auto; }
        .debug-section { background: var(--theme-surface); border: 1px solid var(--theme-border); border-radius: 8px; padding: 1rem; margin: 1rem 0; }
        .status { padding: 0.5rem; margin: 0.5rem 0; border-radius: 4px; }
        .success { background: color-mix(in oklab, var(--success) 10%, transparent); border: 1px solid var(--success); }
        .error { background: color-mix(in oklab, var(--danger) 10%, transparent); border: 1px solid var(--danger); }
        #badge-test { text-align: center; padding: 1rem; background: var(--theme-bg); border-radius: 4px; margin: 1rem 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Debug Badges Component</h1>

        <div class="debug-section">
            <h2>1. Test de Base</h2>
            <div id="debug-output">‚è≥ Chargement...</div>

            <div id="badge-test">
                <div id="test-badge"></div>
            </div>
        </div>

        <div class="debug-section">
            <h2>2. Console Output</h2>
            <p>Ouvre la console (F12) pour voir les logs d√©taill√©s.</p>
        </div>
    </div>

    <script>
        // Test sans modules d'abord
        console.log('üîç [Debug] Page loaded, testing basic functionality...');

        const output = document.getElementById('debug-output');

        function addStatus(message, type = 'info') {
            console.log(`üîç [Debug] ${message}`);
            const statusDiv = document.createElement('div');
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = `${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'} ${message}`;
            output.appendChild(statusDiv);
        }

        addStatus('Page charg√©e, test des modules...', 'info');

        // Test module import
        import('./components/Badges.js')
            .then(module => {
                addStatus('Module Badges.js import√© avec succ√®s', 'success');
                console.log('üîç [Debug] Badges module:', module);

                if (typeof module.renderBadges === 'function') {
                    addStatus('Fonction renderBadges disponible', 'success');

                    try {
                        const testContainer = document.getElementById('test-badge');
                        module.renderBadges(testContainer, {
                            source: 'Debug Test',
                            updated: new Date(),
                            contradiction: 42,
                            cap: 7,
                            overrides: 1,
                            status: 'healthy'
                        });
                        addStatus('Badge de test rendu avec succ√®s !', 'success');

                        // V√©rifier si le CSS est inject√©
                        setTimeout(() => {
                            const cssEl = document.getElementById('governance-badges-css');
                            if (cssEl) {
                                addStatus('CSS des badges inject√© correctement', 'success');
                            } else {
                                addStatus('CSS des badges non trouv√©', 'error');
                            }
                        }, 100);

                    } catch (renderError) {
                        addStatus(`Erreur de rendu: ${renderError.message}`, 'error');
                        console.error('üîç [Debug] Render error:', renderError);
                    }

                } else {
                    addStatus('Fonction renderBadges non disponible', 'error');
                }

                // Test autres exports
                const exports = Object.keys(module);
                addStatus(`Exports disponibles: ${exports.join(', ')}`, 'info');

            })
            .catch(importError => {
                addStatus(`Erreur d'import: ${importError.message}`, 'error');
                console.error('üîç [Debug] Import error:', importError);
            });
    </script>
</body>
</html>