<!DOCTYPE html>
<html>
<head>
    <title>Test Debug Menu Navigation</title>
    <script src="../../static/shared-header.js"></script>
    <script src="../../static/global-config.js"></script>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.6; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background: #d4f6d4; }
        .info { background: #d1ecf1; }
        .warning { background: #fef3cd; }
        code { background: #f8f9fa; padding: 2px 6px; border-radius: 4px; }
        .demo-buttons { display: flex; gap: 10px; margin: 10px 0; flex-wrap: wrap; }
        .demo-btn { 
            padding: 8px 16px; 
            border: 1px solid #007bff; 
            background: #fff; 
            color: #007bff; 
            border-radius: 6px; 
            cursor: pointer; 
            transition: all 0.2s;
        }
        .demo-btn:hover { background: #007bff; color: white; }
    </style>
</head>
<body>
    <div id="shared-header"></div>

    <h1>🛠️ Test Debug Menu Navigation</h1>

    <div class="test-section info">
        <h3>📋 Fonctionnalités du Menu Debug</h3>
        <p>Le menu debug permet d'accéder rapidement aux tests HTML les plus importants organisés par catégorie :</p>
        <ul>
            <li><strong>🔧 Core System</strong> : Tests des fonctionnalités principales</li>
            <li><strong>📊 Scoring & CCS</strong> : Tests des systèmes de scoring</li> 
            <li><strong>🎨 UI & Navigation</strong> : Tests d'interface utilisateur</li>
            <li><strong>🌐 Data & API</strong> : Tests de données et API</li>
        </ul>
    </div>

    <div class="test-section warning">
        <h3>🔓 Activation du Mode Debug</h3>
        <p>Plusieurs méthodes pour activer le mode debug :</p>
        
        <div class="demo-buttons">
            <button class="demo-btn" onclick="activateDebugURL()">
                🔗 URL Parameter
            </button>
            <button class="demo-btn" onclick="toggleDebugConfig()">
                ⚙️ Toggle Config
            </button>
            <button class="demo-btn" onclick="showDoubleClickHint()">
                🖱️ Double-Click Hint
            </button>
        </div>

        <div id="activation-info" style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 6px; display: none;"></div>
    </div>

    <div class="test-section success" id="debug-status">
        <h3>🔍 État Actuel du Debug</h3>
        <p>Mode debug : <span id="debug-mode-status">Chargement...</span></p>
        <p>Menu visible : <span id="debug-menu-visible">Vérification...</span></p>
    </div>

    <div class="test-section">
        <h3>📚 Instructions d'Utilisation</h3>
        <ol>
            <li><strong>Activation par URL</strong> : Ajouter <code>?debug=true</code> à l'URL</li>
            <li><strong>Activation Persistante</strong> : Double-cliquer sur le bouton "Settings" dans la navigation</li>
            <li><strong>Accès au Menu</strong> : Cliquer sur "🛠️ Debug Tests" pour ouvrir le dropdown</li>
            <li><strong>Navigation</strong> : Les liens ouvrent directement les tests dans le même onglet</li>
            <li><strong>Désactivation</strong> : Re-double-cliquer sur "Settings" ou enlever le paramètre URL</li>
        </ol>
    </div>

    <script>
        // Initialize shared header
        window.addEventListener('DOMContentLoaded', function() {
            initSharedHeader('test-debug-menu', { showConfigIndicators: false });
            updateDebugStatus();
        });

        // Activation par URL parameter
        function activateDebugURL() {
            const newURL = window.location.origin + window.location.pathname + '?debug=true';
            document.getElementById('activation-info').innerHTML = `
                <strong>🔗 Méthode URL Parameter</strong><br>
                Ajoutez <code>?debug=true</code> à n'importe quelle URL pour activer temporairement le mode debug.<br>
                <a href="${newURL}" style="color: #007bff;">Exemple : ${newURL}</a>
            `;
            document.getElementById('activation-info').style.display = 'block';
        }

        // Toggle debug via config
        function toggleDebugConfig() {
            if (window.globalConfig) {
                const newMode = window.globalConfig.toggleDebugMode();
                document.getElementById('activation-info').innerHTML = `
                    <strong>⚙️ Configuration Toggleée</strong><br>
                    Mode debug maintenant : <strong>${newMode ? 'ACTIVÉ' : 'DÉSACTIVÉ'}</strong><br>
                    Cette configuration est persistante dans localStorage.
                `;
                document.getElementById('activation-info').style.display = 'block';
                setTimeout(updateDebugStatus, 500);
            }
        }

        // Hint pour double-click
        function showDoubleClickHint() {
            document.getElementById('activation-info').innerHTML = `
                <strong>🖱️ Double-Click sur Settings</strong><br>
                Double-cliquez rapidement sur le bouton "⚙️ Settings" dans la navigation pour toggle le mode debug.<br>
                Une notification apparaîtra pour confirmer l'activation/désactivation.
            `;
            document.getElementById('activation-info').style.display = 'block';
        }

        // Met à jour l'affichage du statut debug
        function updateDebugStatus() {
            setTimeout(() => {
                const isDebug = window.globalConfig ? window.globalConfig.isDebugMode() : false;
                const menuVisible = document.querySelector('.debug-section') !== null;
                
                document.getElementById('debug-mode-status').innerHTML = 
                    `<strong style="color: ${isDebug ? 'green' : 'red'};">${isDebug ? '✅ ACTIVÉ' : '❌ DÉSACTIVÉ'}</strong>`;
                    
                document.getElementById('debug-menu-visible').innerHTML = 
                    `<strong style="color: ${menuVisible ? 'green' : 'red'};">${menuVisible ? '👁️ VISIBLE' : '🚫 MASQUÉ'}</strong>`;
            }, 200);
        }

        // Écouter les changements de debug mode
        window.addEventListener('debugModeChanged', updateDebugStatus);
    </script>
</body>
</html>