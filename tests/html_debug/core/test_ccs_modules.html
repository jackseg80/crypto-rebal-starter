<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test CCS Modules</title>
</head>
<body>
    <h1>Testing CCS Module Loading</h1>
    <div id="results"></div>
    <button id="testBtn">Test Strategy Function</button>

    <script type="module">
        // Test module imports
        import { fetchAndComputeCCS, interpretCCS, DEFAULT_CCS_WEIGHTS } from './static/modules/signals-engine.js';
        import { estimateCyclePosition, blendCCS, getCyclePhase } from './static/modules/cycle-navigator.js';
        import { proposeTargets, applyTargets } from './static/modules/targets-coordinator.js';
        import { store } from './static/core/risk-dashboard-store.js';

        const results = document.getElementById('results');
        
        async function testModules() {
            try {
                results.innerHTML += '<p>✅ All modules imported successfully</p>';
                
                // Test fetchAndComputeCCS
                const ccs = await fetchAndComputeCCS();
                results.innerHTML += `<p>✅ CCS Score: ${ccs.score}</p>`;
                
                // Test estimateCyclePosition  
                const cycle = estimateCyclePosition();
                results.innerHTML += `<p>✅ Cycle Phase: ${cycle.phase.phase} (${Math.round(cycle.months)}m)</p>`;
                
                // Test proposeTargets
                store.set('ccs', ccs);
                store.set('cycle', cycle);
                
                const proposal = proposeTargets('blend');
                results.innerHTML += `<p>✅ Targets proposed: ${proposal.strategy}</p>`;
                results.innerHTML += `<p>BTC allocation: ${proposal.targets.BTC?.toFixed(1)}%</p>`;
                
                // Test applyTargets
                window.testApplyStrategy = async function(mode) {
                    try {
                        console.log('Testing strategy:', mode);
                        const proposal = proposeTargets(mode);
                        console.log('Proposal:', proposal);
                        await applyTargets(proposal);
                        results.innerHTML += `<p>✅ Applied strategy: ${mode}</p>`;
                    } catch (error) {
                        console.error('Strategy test error:', error);
                        results.innerHTML += `<p>❌ Strategy error: ${error.message}</p>`;
                    }
                };
                
                document.getElementById('testBtn').onclick = () => window.testApplyStrategy('blend');
                
            } catch (error) {
                console.error('Module test error:', error);
                results.innerHTML += `<p>❌ Error: ${error.message}</p>`;
            }
        }
        
        testModules();
    </script>
</body>
</html>